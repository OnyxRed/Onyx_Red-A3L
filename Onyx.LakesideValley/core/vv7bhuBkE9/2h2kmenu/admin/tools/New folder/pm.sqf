/*
	File: pm.sqf
*/
if!("ItemMap"in items player)then{player addweapon"ItemMap";};
W_O_O_K_I_E_Noobs=[];
W_O_O_K_I_E_Bitches=[];
if(isnil"W_O_O_K_I_E_Map_Markers")then{W_O_O_K_I_E_Map_Markers=0;};
if(W_O_O_K_I_E_Map_Markers==0)then{W_O_O_K_I_E_Map_Markers=1;hint"Player Markers ON";}else{W_O_O_K_I_E_Map_Markers=0;hint"Player Markers OFF";};
while{W_O_O_K_I_E_Map_Markers==1}do{{if((vehicle _x isKindOf"LandVehicle")||(vehicle _x isKindOf"Air")||(vehicle _x isKindOf"Ship"))then{if(count(crew vehicle _x)>0)then{{if(!(_x in W_O_O_K_I_E_Noobs)and(alive _x)and(getPlayerUID _x!=""))then{private["_pos","_l44","_l45"];_l45=vehicle _x;_pos=visiblePosition _x;_l44=createMarkerLocal[format["CRW%1%2",_pos select 0,_pos select 1],[(_pos select 0)+20,_pos select 1,0]];_l8=(gettext(configFile>>'CfgVehicles'>>(typeof vehicle _x)>>'displayName'));_l44 setMarkerTextLocal format['%1---%2---%3m',name _x,_l8,round(_x distance player)];_l44 setMarkerTypeLocal"mil_dot";if((side _x==side player)and(side _x!=resistance))then{_l44 setMarkerColorLocal"ColorBlue";}else{_l44 setMarkerColorLocal"ColorRed";};_l44 setMarkerSizeLocal[1,1];W_O_O_K_I_E_Noobs set[count W_O_O_K_I_E_Noobs,_x];[_x,_l44,_l45]spawn{private["_l46","_l47","_l48"];_l46=_this select 0;_l47=_this select 1;while{(W_O_O_K_I_E_Map_Markers==1)and(alive _l46)and(vehicle _l46!=_l46)and(getPlayerUID _l46!="")}do{_l48=((crew vehicle _l46)find _l46);_l47 setMarkerPosLocal([(visiblePosition _l46 select 0)+20,(visiblePosition _l46 select 1)-(25+_l48*20),0]);sleep 0.01;};deleteMarkerLocal _l47;if(_l46 in W_O_O_K_I_E_Noobs)then{W_O_O_K_I_E_Noobs set[(W_O_O_K_I_E_Noobs find _l46),-1];W_O_O_K_I_E_Noobs=W_O_O_K_I_E_Noobs-[-1];};true;};};}forEach crew vehicle _x;};}else{if(!(_x in W_O_O_K_I_E_Bitches)and(vehicle _x==_x)and(getPlayerUID _x!=""))then{private["_pos","_l44"];_pos=visiblePosition _x;_l44=createMarkerLocal[format["PLR%1%2",_pos select 0,_pos select 1],[(_pos select 0)+20,_pos select 1,0]];_l44 setMarkerTypeLocal"mil_dot";_l44 setMarkerSizeLocal[1,1];if((side _x==side player)and(side _x!=resistance))then{_l44 setMarkerColorLocal"ColorWhite";}else{_l44 setMarkerColorLocal"ColorRedAlpha";};_l44 setMarkerTextLocal format["%1---%2",name _x,round(_x distance player)];if(_x==player)then{_l44 setMarkerColorLocal"ColorGreen";};W_O_O_K_I_E_Bitches set[count W_O_O_K_I_E_Bitches,_x];[_x,_l44]spawn{private["_l46","_l47"];_l46=_this select 0;_l47=_this select 1;while{(W_O_O_K_I_E_Map_Markers==1)and(alive _l46)and(vehicle _l46==_l46)and(getPlayerUID _l46!="")}do{_l47 setMarkerPosLocal([visiblePosition _l46 select 0,visiblePosition _l46 select 1,0]);sleep 0.01;};deleteMarkerLocal _l47;if(_l46 in W_O_O_K_I_E_Bitches)then{W_O_O_K_I_E_Bitches set[(W_O_O_K_I_E_Bitches find _l46),-1];W_O_O_K_I_E_Bitches=W_O_O_K_I_E_Bitches-[-1];};true;};};};}forEach playableUnits;sleep 0.3;};{_l44=str _x;deleteMarkerLocal _l44;}forEach playableUnits;